var $event=$.event,$special,resizeTimeout;var $nextObj,$prevObj;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(e,t){var n=this,r=arguments,i=function(){e.type="debouncedresize";$event.dispatch.apply(n,r)};if(resizeTimeout){clearTimeout(resizeTimeout)}t?i():resizeTimeout=setTimeout(i,$special.threshold)},threshold:250};var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(e){function a(){var r=$(o),s=$(u);if(n){if(u.length){n.reject(i,r,s)}else{n.resolve(i)}}if($.isFunction(e)){e.call(t,i,r,s)}}function f(e,t){if(e.src===BLANK||$.inArray(e,s)!==-1){return}s.push(e);if(t){u.push(e)}else{o.push(e)}$.data(e,"imagesLoaded",{isBroken:t,src:e.src});if(r){n.notifyWith($(e),[t,i,$(o),$(u)])}if(i.length===s.length){setTimeout(a);i.unbind(".imagesLoaded")}}var t=this,n=$.isFunction($.Deferred)?$.Deferred():0,r=$.isFunction(n.notify),i=t.find("img").add(t.filter("img")),s=[],o=[],u=[];if($.isPlainObject(e)){$.each(e,function(t,r){if(t==="callback"){e=r}else if(n){n[t](r)}})}if(!i.length){a()}else{i.bind("load.imagesLoaded error.imagesLoaded",function(e){f(e.target,e.type==="error")}).each(function(e,t){var n=t.src;var r=$.data(t,"imagesLoaded");if(r&&r.src===n){f(t,r.isBroken);return}if(t.complete&&t.naturalWidth!==undefined){f(t,t.naturalWidth===0||t.naturalHeight===0);return}if(t.readyState||t.complete){t.src=BLANK;t.src=n}})}return n?n.promise(t):t};$(function(){$.elastic_grid={version:"1.0"};$.fn.elastic_grid=function(e){function h(e,t){e.each(function(e,n){if(classie.has(n,t)){classie.toggle(n,"animate");classie.remove(n,"hidden")}else{classie.add(n,"hidden");classie.remove(n,"animate")}})}function p(e){var t=e.toLowerCase().replace(" ","-");if(e!=""){var n=$("<li>");var r=$("<a>",{html:e,"data-filter":"."+t,href:"#","class":"filter"}).appendTo(n);n.appendTo(f)}}function k(e){v=v.add(e);e.each(function(){var e=$(this);e.data({offsetTop:e.offset().top,height:e.height()})});O(e)}function L(e){v.each(function(){var t=$(this);t.data("offsetTop",t.offset().top);if(e){t.data("height",t.height())}})}function A(){O(v);w.on("debouncedresize",function(){y=0;g=-1;L();M();var e=$.data(this,"preview");if(typeof e!="undefined"){D()}})}function O(e){e.on("click","span.og-close",function(){D();e.children().find("figure").css("top","100%");return false}).children("a").on("click",function(e){var t=$(this).parent();t.removeClass("animate");m===t.index()?D($(this)):_(t);return false})}function M(){E={width:w.width(),height:w.height()}}function _(e){D();var t=$.data(this,"preview"),n=e.data("offsetTop");y=0;if(typeof t!="undefined"){if(g!==n){if(n>g){y=t.height}D()}else{t.update(e);return false}}g=n;t=$.data(this,"preview",new P(e));t.open()}function D(){v.find(".og-pointer").remove();m=-1;var e=$.data(this,"preview");if(typeof e=="undefined"){}else{e.close()}$.removeData(this,"preview")}function P(t){this.$item=t;this.expandedIdx=this.$item.index();this.create();this.update();e.exOnClickEvent()}var t=Math.floor(Math.random()*6);var n=["moveup","scaleup","fallperspective","fly","flip","helix","popup"];e.filterEffect=e.filterEffect=="random"?n[t]:e.filterEffect;e=$.extend({},{items:null,filterEffect:"",hoverDirection:true,hoverDelay:0,hoverInverse:false,expandingHeight:500,expandingSpeed:300,exHideInfoBoxTitle:false,exControls:false,exControlsCSS:{position:"absolute",cursor:"pointer",padding:5,marginTop:"15%"},exControlsNextText:"Next",exControlsNextClass:null,exControlsPrevText:"Prev",exControlsPrevClass:null,exOnClickEvent:function(){},callback:function(){}},e);var r=$(this);var i=e.items.length;if(i==0){return false}r.html('<div class="wagwep-container"><nav id="porfolio-nav" class="clearfix"><ul id="portfolio-filter" class="nav nav-tabs clearfix"></ul></nav></div>');var s="";var o=$('<ul id="og-grid" class="og-grid"></ul>');for(itemIdx=0;itemIdx<i;itemIdx++){if(e.items[itemIdx]!=undefined){var u=e.items[itemIdx];liObject=$("<li></li>");tags=u.tags;strTag="";for(var a=tags.length-1;a>=0;a--){strTag+=","+tags[a]}strTag=strTag.substring(1);liObject.attr("data-tags",strTag);aObject=$("<a></a>");aObject.attr("href","javascript:;;");imgObject=$("<img/>");imgObject.attr("src",u.thumbnail[0]);imgObject.attr("data-largesrc",u.large[0]);spanObject=$("<span></span>");spanObject.html(u.title);figureObject=$("<figure></figure>");figureObject.append(spanObject);imgObject.appendTo(aObject);figureObject.appendTo(aObject);aObject.appendTo(liObject);liObject.appendTo(o)}}if(e.filterEffect==""){e.filterEffect="moveup"}o.addClass("effect-"+e.filterEffect);o.appendTo(r);if(e.hoverDirection==true){o.find("li").each(function(){$(this).hoverdir({hoverDelay:e.hoverDelay,inverse:e.hoverInverse})})}var f=r.find("#portfolio-filter");var l=o.find("li"),c={};numOfTag=0;l.each(function(e){var t=$(this),n=t.data("tags").split(",");t.attr("data-id",e);t.addClass("all");$.each(n,function(e,n){n=$.trim(n);t.addClass(n.toLowerCase().replace(" ","-"));if(!(n in c)){c[n]=[];numOfTag++}c[n].push(t)})});if(numOfTag>1){p("All");$.each(c,function(e,t){p(e)})}else{f.remove()}f.find("a").bind("click",function(e){d.find("li.og-expanded").find("a").trigger("click");d.find(".og-close").trigger("click");$this=$(this);$this.css("outline","none");f.find(".current").removeClass("current");$this.parent().addClass("current");var t=$this.text().toLowerCase().replace(" ","-");var n=i;o.find("li").each(function(e,r){classie.remove(r,"hidden");classie.remove(r,"animate");if(!--n){setTimeout(function(){h(o.find("li"),t)},1)}});return false});f.find("li:first").addClass("current");var d=o,v=d.children("li"),m=-1,g=-1,y=0,b=10,w=$(window),E,S=$("html, body"),x={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},T=x[Modernizr.prefixed("transition")],N=Modernizr.csstransitions,C={minHeight:e.expandingHeight,speed:e.expandingSpeed,easing:"ease"};P.prototype={create:function(){if(e.exControls==true){this.$itemNext=$("<span>"+e.exControlsNextText+"</span>");this.$itemNext.css({right:0});if(e.exControlsCSS!=null)this.$itemNext.css(e.exControlsCSS);if(e.exControlsNextClass!=null)this.$itemNext.addClass(e.exControlsNextClass);this.$itemNext.click(function(){var e=$(this).parent().parent().parent().parent().children();e.find("figure").css("top","100%");var t=$(this).parent().parent().parent();var n=t.data("tags");var r=t.index();e.removeClass("animate");if($("#portfolio-filter").find("li[class=current]").children().data("filter")==".all"){if($(this).parent().parent().parent().next().length>0){$nextObj=$(this).parent().parent().parent().next();_($nextObj);setTimeout(function(){$("html,body").animate({scrollTop:$nextObj.offset().top},1e3)},1e3)}return}var i=[];for(var s=0;s<e.length;s++){if(n.indexOf(",")>=0){var o=n.split(",");for(var u=0;u<o.length;u++){if(e.eq(s).data("tags").indexOf(o[u])>=0){if($.inArray(s,i)<0){i.push(s)}}}}else{if(e.eq(s).data("tags").indexOf(n)>=0){i.push(s)}}}if(e.eq(i[$.inArray(r,i)+1]).length>0){$nextObj=e.eq(i[$.inArray(r,i)+1]);_($nextObj);setTimeout(function(){$("html,body").animate({scrollTop:$nextObj.offset().top},1e3)},1e3)}});this.$itemPrev=$("<span>"+e.exControlsPrevText+"</span>");this.$itemPrev.css({left:0});if(e.exControlsCSS!=null)this.$itemPrev.css(e.exControlsCSS);if(e.exControlsPrevClass!=null)this.$itemPrev.addClass(e.exControlsPrevClass);this.$itemPrev.click(function(){var e=$(this).parent().parent().parent().parent().children();e.find("figure").css("top","100%");var t=$(this).parent().parent().parent();var n=t.data("tags");var r=t.index();e.removeClass("animate");if($("#portfolio-filter").find("li[class=current]").children().data("filter")==".all"){if($(this).parent().parent().parent().prev().length>0){$prevObj=$(this).parent().parent().parent().prev();_($prevObj);setTimeout(function(){$("html,body").animate({scrollTop:$prevObj.offset().top},1e3)},1e3)}return}var i=[];for(var s=0;s<e.length;s++){if(n.indexOf(",")>=0){var o=n.split(",");for(var u=0;u<o.length;u++){if(e.eq(s).data("tags").indexOf(o[u])>=0){if($.inArray(s,i)<0){i.push(s)}}}}else{if(e.eq(s).data("tags").indexOf(n)>=0){i.push(s)}}}if(e.eq(i[$.inArray(r,i)-1]).length>0){$prevObj=e.eq(i[$.inArray(r,i)-1]);_($prevObj);setTimeout(function(){$("html,body").animate({scrollTop:$prevObj.offset().top},1e3)},1e3)}})}this.$title=$("<h3></h3>");this.$description=$("<p></p>");this.$href=$('<a href="#">Visit website</a>');this.$detailButtonList=$('<span class="buttons-list"></span>');this.$details=$('<div class="og-details"></div>').append(this.$title,this.$description,this.$detailButtonList);this.$loading=$('<div class="og-loading"></div>');this.$fullimage=$('<div class="og-fullimg"></div>').append(this.$loading);this.$closePreview=$('<span class="og-close"></span>');this.$previewInner=$('<div class="og-expander-inner"></div>').append(this.$itemNext,this.$itemPrev,this.$closePreview,this.$fullimage,this.$details);this.$previewEl=$('<div class="og-expander"></div>').append(this.$previewInner);this.$item.append($('<div class="og-pointer"></div>'));this.$item.append(this.getEl());if(N){this.setTransition()}},update:function(t){if(t){this.$item=t}if(m!==-1){var n=v.eq(m);n.removeClass("og-expanded");this.$item.addClass("og-expanded");this.positionPreview()}m=this.$item.index();if(typeof e.items[m]==="undefined"){}else{eldata=e.items[m];if(e.exHideInfoBoxTitle==false)this.$title.html(eldata.title);this.$description.html(eldata.description);this.$detailButtonList.html("");urlList=eldata.button_list;if(urlList.length>0){for(a=0;a<urlList.length;a++){var r=$("<a></a>");r.addClass("link-button");if(a==0){r.addClass("first")}r.attr("href",urlList[a]["url"]);r.html(urlList[a]["title"]);this.$detailButtonList.append(r)}}var i=this;if(typeof i.$largeImg!="undefined"){i.$largeImg.remove()}glarge=eldata.large;gthumbs=eldata.thumbnail;if(glarge.length==gthumbs.length&&glarge.length>0){var s=$("<ul></ul>");for(a=0;a<gthumbs.length;a++){var o=$("<li></li>");var r=$('<a href="javascript:;;"></a>');var u=$("<img/>");u.addClass("related_photo");if(a==0){u.addClass("selected")}u.attr("src",gthumbs[a]);u.attr("data-large",glarge[a]);r.append(u);o.append(r);s.append(o)}s.addClass("elastislide-list");s.elastislide();var f=$('<div class="elastislide-wrapper elastislide-horizontal"></div>');f.append(s).find(".related_photo").bind("click",function(){f.find(".selected").removeClass("selected");$(this).addClass("selected");$largePhoto=$(this).data("large");$(".og-fullimg").fadeOut(100,function(){$(this).fadeIn(500).html($largePhoto)})});i.$details.prepend('<div class="infosep"></div>');i.$details.prepend(f)}else{i.$details.find(".infosep, .og-grid-small").remove()}$(".og-fullimg").html(eldata.large[0])}},open:function(){setTimeout($.proxy(function(){this.setHeights();this.positionPreview()},this),25)},close:function(){var e=this,t=function(){if(N){$(this).off(T)}e.$item.removeClass("og-expanded");e.$previewEl.remove()};setTimeout($.proxy(function(){if(typeof this.$largeImg!=="undefined"){this.$largeImg.fadeOut("fast")}this.$previewEl.css("height",0);var e=v.eq(this.expandedIdx);e.css("height",e.data("height")).on(T,t);if(!N){t.call()}},this),25);return false},calcHeight:function(){var e=E.height-this.$item.data("height")-b,t=E.height;if(e<C.minHeight){e=C.minHeight;t=C.minHeight+this.$item.data("height")+b}this.height=e;this.itemHeight=t},setHeights:function(){var e=this,t=function(){if(N){e.$item.off(T)}e.$item.addClass("og-expanded")};this.calcHeight();this.$previewEl.css("height",this.height);this.$item.css("height",this.itemHeight).on(T,t);if(!N){t.call()}},positionPreview:function(){var e=this.$item.data("offsetTop"),t=this.$previewEl.offset().top-y,n=this.height+this.$item.data("height")+b<=E.height?e:this.height<E.height?t-(E.height-this.height):t;S.animate({scrollTop:n},C.speed)},setTransition:function(){this.$previewEl.css("transition","height "+C.speed+"ms "+C.easing);this.$item.css("transition","height "+C.speed+"ms "+C.easing)},getEl:function(){return this.$previewEl}};d.imagesLoaded(function(){L(true);M();A()})}})